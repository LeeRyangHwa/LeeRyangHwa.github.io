<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>3.영속성관리 - Dot com factory</title>
<meta name="description" content="영속성관리">


  <meta name="author" content="SW Factory Owner">
  
  <meta property="article:author" content="SW Factory Owner">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Dot com factory">
<meta property="og:title" content="3.영속성관리">
<meta property="og:url" content="http://localhost:4000/spring/spring-jpa-chapter3/">


  <meta property="og:description" content="영속성관리">



  <meta property="og:image" content="http://localhost:4000/assets/images/photo_default.png">





  <meta property="article:published_time" content="2020-11-19T00:00:00+00:00">





  

  


<link rel="canonical" href="http://localhost:4000/spring/spring-jpa-chapter3/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "SW Factory Owner",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Dot com factory Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Dot com factory
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">카테고리</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">POST</a>
            </li><li class="masthead__menu-item">
              <a href="https://blog.naver.com/dlfidghk">블로그 방문</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/photo_default.png" alt="SW Factory Owner" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">SW Factory Owner</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>소소한 기록들</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">South Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:iryanghwa@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/LeeRyangHwa" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="3.영속성관리">
    <meta itemprop="description" content="영속성관리">
    <meta itemprop="datePublished" content="2020-11-19T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">3.영속성관리
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> 영속성관리</h4></header>
              <ul class="toc__menu">
  <li><a href="#엔티티-매니저-팩토리와-엔티티-매니저">엔티티 매니저 팩토리와 엔티티 매니저</a>
    <ul>
      <li><a href="#영속성-컨텍스트의-특징">영속성 컨텍스트의 특징</a></li>
    </ul>
  </li>
  <li><a href="#플러시">플러시</a>
    <ul>
      <li><a href="#플러시-모드-옵션">플러시 모드 옵션</a></li>
    </ul>
  </li>
  <li><a href="#준영속">준영속</a>
    <ul>
      <li><a href="#준영속-상태의-특징">준영속 상태의 특징</a></li>
      <li><a href="#병합-merge">병합: merge()</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <p>JPA가 제공하는 기능은 크게 엔티티와 테이블을 매핑하는 설계 부분과 매핑한 엔티티를 실제 사용하는 부분으로 나뉜다.</p>

<ul>
  <li>엔티티 매니저: 엔티티를 저장,수정, 삭제, 조회 등 엔티티와 관련된 모든 일을 처리</li>
</ul>

<h2 id="엔티티-매니저-팩토리와-엔티티-매니저">엔티티 매니저 팩토리와 엔티티 매니저</h2>

<ul>
  <li>엔티티 매니저 팩토리</li>
</ul>

<p>데이터 베이스를 하나만 사용하는 애플리케이션은 일반적으로 EntityManagerFactroy를 하나만 생성한다.</p>

<p>⇒ 비용이 많이 든다.(공장 만들기)</p>

<p>⇒ META-INF/persistence.xml에 있는 정보를 바탕으로 EntityManagerFactory를 생성한다.</p>

<ul>
  <li>엔티티 매니저</li>
</ul>

<p>⇒ 비용이 거의 안든다.</p>

<p>⇒ 엔티티 매니저 팩토리에서 생성된다.</p>

<p><strong>엔티티 매니저 팩토리는 여러 스레드가 동시에 접근해도 안전하므로 서로 다른 스레드 간에 공유해도 되지만, 엔티티 매니저는 여러 스레드가 동시에 접근하면 동시성 문제가 발생하므로 절대 공유하면 안된다.</strong></p>

<ul>
  <li><strong>JPA를 이해하는데 가장 중요한 용어는 영속성 컨텍스트</strong></li>
</ul>

<p>영속성 컨텍트: 엔티티를 영구 저장하는 환경이라는 뜻</p>

<p>영속성 컨텍트는 엔티티 매니저를 생성할 때 하나 만들어지고 엔티티 매니저를 통해서 접근, 관리 할 수 있다.</p>

<ul>
  <li><strong>엔티티의 4가지 상태</strong></li>
  <li>비영속</li>
  <li>영속</li>
  <li>준영속</li>
  <li>삭제</li>
</ul>

<h3 id="영속성-컨텍스트의-특징">영속성 컨텍스트의 특징</h3>

<ul>
  <li>
    <p>영속성 컨텍스트와 식별자 값</p>
  </li>
  <li>
    <p>영속성 컨텍스트와 데이터베이스 저장</p>
  </li>
  <li>
    <p>영속성 컨텍스트가 엔티티를 관리할 때 장점</p>
    <ol>
      <li>
        <p>1차 캐시</p>

        <p>영속성 컨텍스트는 내부에 캐시를 가지고 있다. (1차 캐시라 부름)</p>

        <p>⇒ 영속성 컨텍스트 내부에 Map이 존재, @Id로 매핑한 식별자 , 값은 엔티티 인스턴스이다.</p>

        <p>em.find()를 호출 했을 때 찾는 엔티티가 1차 캐시에 엔티티가 있다면 바로 조회, 없으면 데이터베이스에서 조회 후 1차 엔티티에 저장</p>

        <p>⇒ 한번 저장된 엔티티를 조회할 경우 성능상 이점을 누릴수 있다.</p>
      </li>
      <li>
        <p>동일성 보장</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Member</span> <span class="n">a</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
 <span class="nc">Member</span> <span class="n">b</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>

 <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="o">);</span>
</code></pre></div>        </div>

        <p>1차 캐시에 있는 같은 엔티티 인스턴스를 반환</p>

        <p>⇒ 영속성 컨텍스트는 성능상 이점과 엔티티의 동일성을 보장</p>

        <ul>
          <li>동일성 : 참조 값을 비교</li>
          <li>동등성: 인스턴스를 다르지만 값은 같다.</li>
        </ul>
      </li>
      <li>
        <p>트랜잭션을 지원하는 쓰기 지연</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
 <span class="nc">EntityTransaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>

 <span class="n">transaction</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>

 <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">memberA</span><span class="o">);</span>
 <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">memberB</span><span class="o">);</span>
 <span class="c1">//커밋 순간에 데이터베이스에 insert sql을 보낸다.</span>
 <span class="n">transaction</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></div>        </div>

        <p>엔티티 매니저는 트랜잭션을 커밋하기 직전까지 데이터베이스에 엔티티를 저장하지 않고 내부 쿼리 저장소에 모은다.( 이것을 트랜잭션을 지원하는 쓰기 지연이라 한다.)</p>

        <p>⇒ 커밋 후 → 영속성 컨텍스트를 플러시한다.</p>

        <p><strong>플러시: 영속성 컨텍스트의 변경 내용을 데이터베이스에 동기화하는 작업.  등록, 수정, 삭제한 엔티티를 데이터베이스에 반영</strong></p>

        <ul>
          <li>
            <p>SQL 수정 쿼리의 문제점</p>

            <p>두개의 수정 쿼리를 합쳐서 하나의 수정 쿼리만을 사용해도 된다.</p>

            <p>⇒ 하지만 합쳐진 쿼리는 특정 값이 입력되지 않을 수 있다. 이러한 상황을 피하기 위해 수정 쿼리를 상황에 따라 추가해야 한다.</p>

            <p><strong>이러한 개발 방식의 문제점은 수정 쿼리가 많아지는 것은 물론이고 비즈니스 로직을 분석하기 위해 SQL을 계속 확인해야 한다.( 결국 비즈니스 로직이 SQL에 의존)</strong></p>
          </li>
        </ul>
      </li>
      <li>
        <p>변경 감지</p>

        <p>JPA는 엔티티를 어떻게 수정할까</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
 <span class="nc">EntityTransaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>

 <span class="n">transaction</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>

 <span class="nc">Member</span> <span class="n">memberA</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"memberA"</span><span class="o">);</span>

 <span class="c1">//영속 엔티티 데이터 수정</span>
 <span class="n">memberA</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"hi"</span><span class="o">);</span>
 <span class="n">memberA</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
 <span class="c1">//커밋 순간에 데이터베이스에 insert sql을 보낸다.</span>
 <span class="n">transaction</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></div>        </div>

        <p>엔티티의 변경사항을 데이터베이스에 자동으로 반영하는 기능을 변경 감지라고 한다.</p>

        <p>JPA는 엔티티를 영속성 컨텍스트에 보관할 때, 최초 상태를 복사해서 저장해두는데 이것을 스냅샷이라 한다.</p>

        <p>⇒ 스냅샷과 엔티티를 비교해서 변경된 엔티티를 찾는다.</p>

        <p>→ 변경된 엔티티가 있으면 수정 쿼리를 생성해서 쓰기 지연 SQL 저장소에 보낸다.</p>

        <p>→ 쓰기 지연 저장소의 SQL을 데이터베이스에 보낸다.</p>

        <p>→ 트랜잭션을 커밋</p>

        <ul>
          <li>변경 감지는 영속성 컨텍스트가 관리하는 영속 상태의 엔티티에만 적용된다.</li>
        </ul>

        <p>JPA의 기본 전략은 엔티티의 모든 필드를 업데이트한다.</p>

        <p>이렇게 모든 필드를 사용하면 데이터베이스에 보내는 데이터 전송량이 증가하는 단점이 있지만 다음과 같은 장점으로 인해 모든 필드를 업데이트 한다.</p>

        <ul>
          <li>모든 필드를 사용하면 수정 쿼리가 항상 같다. (재사용가능)</li>
          <li>데이터베이스에 동일한 쿼리를 보내면 데이터베이스는 이전에 한 번 파싱된 쿼리를 재사용 할 수 있다.</li>
        </ul>

        <p>⇒ 하지만 필드가 많거나 저장되는 내용이 너무 크면 수정된 데이터만 사용해서 동적으로 UPDATE SQL을 생성하는 전략을 선택하면 된다.</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nd">@Entity</span>
 <span class="nd">@org</span><span class="o">.</span><span class="na">hrbernate</span><span class="o">.</span><span class="na">annotations</span><span class="o">.</span><span class="na">DynamicUpdate</span>
 <span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Member"</span><span class="o">)</span>
 <span class="kd">public</span> <span class="kd">class</span> <span class="nf">Member</span><span class="o">()</span>
</code></pre></div>        </div>

        <p>데이터가 존재하는 필드만으로 INSERT SQL을 동적으로 생성하는 @DynamicInsert도 있다.</p>

        <ul>
          <li>컬럼이 대략 30개 이상이 되면 @DynamicUpdate를 사용한 동적 수정 쿼리가 빠르다고 한다.</li>
        </ul>
      </li>
      <li>
        <p>지연 로딩</p>

        <p>엔티티를 삭제하려면 먼저 삭제 대상 엔티티를 조회해야한다.</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Member</span> <span class="n">memberA</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"memberA"</span><span class="o">);</span>
 <span class="n">em</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">memberA</span><span class="o">);</span>
</code></pre></div>        </div>

        <p>remove()에 삭제 대상 엔티티를 넘겨주면 엔티티를 삭제한다.</p>

        <p>하지만 바로 엔티티를 삭제하는 것이 아니라 엔티티 등록과 비슷하게 삭제 쿼리를 쓰기 지연 SQL저장소에 등록한다. 이후 트랜잭션을 커밋해서 플러시를 호출하면 실제 데이터 베이스에 삭제 쿼리를 전달한다.</p>
      </li>
    </ol>
  </li>
</ul>

<h2 id="플러시">플러시</h2>

<p>플러시는 영속성 컨텍스트의 변경 내용을 데이터베이스에 반영한다.</p>

<p>플러시 실행하면 일어나는 일</p>

<ol>
  <li>
    <p>변경 감지가 동작해서 영속성 컨텍스트에 있는 모든 엔티티를 스냅샷과 비교해서 수정된 엔티티를 찾는다.</p>

    <p>수정된 엔티티는 수정 쿼리를 만들어 쓰기 지연 SQL 저장소에 등록한다.</p>
  </li>
  <li>
    <p>쓰기 지연 SQL 저장소의 쿼리를 데이터베이스에 전송한다.</p>
  </li>
</ol>

<p>영속성 컨텍스트를 플러시 하는 방법 3가지</p>

<ol>
  <li>em.flush()를 직접 호출
    <ul>
      <li>직접호출</li>
    </ul>
  </li>
  <li>
    <p>트랜잭션 커밋 시 플러시가 자동 호출</p>

    <p>데이터베이스에 변경 내용을 SQL로 전달하지 않고 트랜잭션만 커밋하면 어떤 데이터도 데이터베이스에 반영되지 않는다.</p>

    <ul>
      <li>트랜잭션을 커밋하기 전에 꼭 플러시를 호출해서 영속성 컨텍스트의 변경 내용을 데이터베이스에 반영해야 한다.</li>
    </ul>
  </li>
  <li>
    <p>JPQL쿼리 실행 시 플러시가 자동 호출</p>

    <p>JPQL이나 Criteria 같은 객체지향 쿼리를 호출해도 플러시가 실행된다.</p>

    <p>쿼리를 실행하기 직전에 영속성 컨텍스트를 플러시해서 변경 내용을 데이터베이스에 반영해야한다. 이러한 문제를 예방하기 위해 JPQL을 실행할 때도 플러시를 자동 호출한다.</p>
  </li>
</ol>

<h3 id="플러시-모드-옵션">플러시 모드 옵션</h3>

<p>엔티티 매니저에 플러시 모드를 직접 지정하려면 javax.persistence.FlushModeType을 사용하면 된다.</p>

<ul>
  <li>
    <p><a href="http://flushmodetype.AUTO">FlushModeType.AUTO</a> : 커밋이나 쿼리를 실행할 때 플러시(기본값)</p>

    <p>플러시 모드를 별도로 설정하지 않으면 AUTO로 동작한다.</p>
  </li>
  <li>
    <p>FlushModeType.COMMIT:커밋할 때만 플러시</p>
  </li>
</ul>

<p><strong>플러시라도 이름으로 인해 영속성 컨텍스트에 보관된 엔티티를 지운다고 생각하면 안된다. 영속성 컨텍스트의 변경 내용을 데이터베이스에 동기화하는 것이 플러시다.</strong></p>

<h2 id="준영속">준영속</h2>

<p>준영속 상태의 엔티티는 영속성 컨텍스트가 제공하는 기능을 사용할 수 없다.</p>

<ol>
  <li>em.detach(entity) : 특정 엔티티만 준영속 상태로 전환한다.</li>
  <li>em.clear(): 영속성 컨텍스트를 완전히 초기화한다.</li>
  <li>em.close(): 영속성 컨텍스트를 종료한다.</li>
</ol>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">em</span><span class="o">.</span><span class="na">detach</span><span class="o">(</span><span class="n">member</span><span class="o">);</span> <span class="c1">//회원 엔티티를 영속성 컨텍스트에서 분리, 준영속 상태</span>
</code></pre></div></div>

<ul>
  <li>엔티티 상태에 대한 용어들은 모두 영속성 컨텍스트와 관련 있는 것</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">em</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span><span class="c1">//영속성 컨텍스트 초기화</span>
</code></pre></div></div>

<ul>
  <li>영속성 컨텍스트를 초기화해 해당 영속성 컨텍스트의 모든 엔티티를 준영속 상태로 만든다.</li>
</ul>

<h3 id="준영속-상태의-특징">준영속 상태의 특징</h3>

<ul>
  <li>
    <p>거의 비영속 상태에 가깝다.</p>

    <p>영속성 컨텍스트가 관리하지 않으므로 1차 캐시,쓰기 지연, 변경 감지, 지연 로딩을 포함한 영속성 컨텍스트가 제공하는 어떠한 기능도 동작하지 않는다.</p>
  </li>
  <li>
    <p>식별자 값을 가지고 있다.</p>

    <p>비영속 상태는 식별자 값이 없을 수 있지만 한번 영속상태였던 준영속 상태는 반드시 식별자 값을 가지고 있다.</p>
  </li>
  <li>
    <p>지연 로딩을 할 수 없다.</p>

    <p>영속성 컨텍스트가 더는 관리하지 않으므로 지연 로딩 시 문제가 발생한다.</p>
  </li>
</ul>

<h3 id="병합-merge">병합: merge()</h3>

<p>준영속 상태의 엔티티를 다시 영속 상태로 변경하려면 병합을 사용하면 된다.</p>

<p>merge()메서드는 준영속 상태의 엔티티를 받아서 그 정보로 새로운 영속 상태의 엔티티를 반환한다.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#jpa" class="page__taxonomy-item" rel="tag">JPA</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#spring" class="page__taxonomy-item" rel="tag">Spring</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-11-19T00:00:00+00:00">November 19, 2020</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=3.%EC%98%81%EC%86%8D%EC%84%B1%EA%B4%80%EB%A6%AC%20http%3A%2F%2Flocalhost%3A4000%2Fspring%2Fspring-jpa-chapter3%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fspring%2Fspring-jpa-chapter3%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fspring%2Fspring-jpa-chapter3%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/spring/spring-jpa-chapter2/" class="pagination--pager" title="2.JPA 시작
">Previous</a>
    
    
      <a href="/spring/spring-jpa-chapter4/" class="pagination--pager" title="4.엔티티 매핑
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/spring-jpa-chapter4/" rel="permalink">4.엔티티 매핑
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">엔티티 매핑
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/spring-jpa-chapter2/" rel="permalink">2.JPA 시작
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">JPA 시작
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/spring-jpa-chapter1/" rel="permalink">1.JPA에 대한 소개
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">JPA에 대한 소개
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/javascript/post-20201116/" rel="permalink">Vuejs 체크 박스 전체 선택
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">체크 박스 전체 선택
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/LeeRyangHwa" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 SW Factory Owner. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
